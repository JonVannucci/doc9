
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  
<!-- Mirrored from jupyterlab.readthedocs.io/en/stable/extension/extension_tutorial.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Feb 2025 04:17:26 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Extension Tutorial &#8212; JupyterLab 4.3.5 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/themeb6e5.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-themeb6e5.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygmentsa032.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton3129.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom5657.css?v=90137069" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesomeb6e5.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrapb6e5.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-themeb6e5.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options941c.js?v=f972b9b1"></script>
    <script src="../_static/doctoolsfd15.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight7f57.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min4664.js?v=a7894cd8"></script>
    <script src="../_static/copybutton7689.js?v=f281be69"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'extension/extension_tutorial';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://jupyterlab.readthedocs.io/en/latest/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'stable';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <link rel="icon" href="../_static/logo-icon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Targeting Multiple Applications" href="extension_multiple_ui.html" />
    <link rel="prev" title="Identity" href="identity.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="4.3" />
  <script async type="text/javascript" src="../../../_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="jupyterlab" /><meta name="readthedocs-version-slug" content="stable" /><meta name="readthedocs-resolver-filename" content="/extension/extension_tutorial.html" /><meta name="readthedocs-http-status" content="200" /></head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="https://jupyterlab.readthedocs.io/en/stable/search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo-rectangle.svg" class="logo__image only-light" alt="JupyterLab"/>
    <img src="../_static/logo-rectangle-dark.svg" class="logo__image only-dark pst-js-only" alt="JupyterLab"/>
  
  
</a></div>
    
      <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/overview.html">
    Get Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="extension_dev.html">
    Develop Extensions
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../developer/contributing.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../privacy_policies.html">
    Privacy policies
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://jupyter.org/" title="jupyter.org" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../_static/jupyter_logo.svg" class="icon-link-image" alt="jupyter.org"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/jupyterlab/jupyterlab" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discourse.jupyter.org/c/jupyterlab/17" title="Discourse" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discourse</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://jupyter.zulipchat.com/channel/469762-jupyterlab" title="Zulip" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-zulip fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Zulip</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/overview.html">
    Get Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="extension_dev.html">
    Develop Extensions
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../developer/contributing.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../privacy_policies.html">
    Privacy policies
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://jupyter.org/" title="jupyter.org" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../_static/jupyter_logo.svg" class="icon-link-image" alt="jupyter.org"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/jupyterlab/jupyterlab" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discourse.jupyter.org/c/jupyterlab/17" title="Discourse" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discourse</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://jupyter.zulipchat.com/channel/469762-jupyterlab" title="Zulip" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-zulip fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Zulip</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="extension_points.html">Common Extension Points</a></li>
<li class="toctree-l1"><a class="reference internal" href="ui_components.html">Reusing JupyterLab UI</a></li>
<li class="toctree-l1"><a class="reference internal" href="documents.html">Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebook.html">Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="virtualdom.html">React</a></li>
<li class="toctree-l1"><a class="reference internal" href="ui_helpers.html">User Interface Helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="internationalization.html">Internationalization and Localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="identity.html">Identity</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Extension Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="extension_multiple_ui.html">Targeting Multiple Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="extension_migration.html">Extension Migration Guide</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="extension_dev.html" class="nav-link">Develop Extensions</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Extension Tutorial</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="extension-tutorial">
<span id="id1"></span><h1>Extension Tutorial<a class="headerlink" href="#extension-tutorial" title="Link to this heading">#</a></h1>
<p>JupyterLab extensions add features to the user experience. This page
describes how to create one type of extension, an <em>application plugin</em>,
that:</p>
<ul class="simple">
<li><p>Adds a “Random <a class="reference external" href="https://apod.nasa.gov/apod/astropix.html">Astronomy Picture</a>” command to the
<em>command palette</em> sidebar</p></li>
<li><p>Fetches the image and metadata when activated</p></li>
<li><p>Shows the image and metadata in a tab panel</p></li>
</ul>
<p>By working through this tutorial, you’ll learn:</p>
<ul class="simple">
<li><p>How to set up an extension development environment from scratch on a
Linux or OSX machine. (You’ll need to modify the commands slightly if you are on Windows.)</p></li>
<li><p>How to start an extension project from
<a class="reference external" href="https://github.com/jupyterlab/extension-template">jupyterlab/extension-template</a></p></li>
<li><p>How to iteratively code, build, and load your extension in JupyterLab</p></li>
<li><p>How to version control your work with git</p></li>
<li><p>How to release your extension for others to enjoy</p></li>
</ul>
<figure class="align-center" id="id5">
<img alt="The completed extension, showing the Astronomy Picture of the Day for 24 Jul 2015." class="jp-screenshot" src="../_images/extension_tutorial_complete.png" />
<figcaption>
<p><span class="caption-text">The completed extension, showing the <a class="reference external" href="https://apod.nasa.gov/apod/ap150724.html">Astronomy Picture of the Day for 24 Jul 2015</a>.</span><a class="headerlink" href="#id5" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Sound like fun? Excellent. Here we go!</p>
<section id="set-up-a-development-environment">
<h2>Set up a development environment<a class="headerlink" href="#set-up-a-development-environment" title="Link to this heading">#</a></h2>
<section id="install-conda-using-miniconda">
<h3>Install conda using miniconda<a class="headerlink" href="#install-conda-using-miniconda" title="Link to this heading">#</a></h3>
<p>Start by installing miniconda, following
<a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/install/index.html">Conda’s installation documentation</a>.</p>
</section>
<section id="install-nodejs-jupyterlab-etc-in-a-conda-environment">
<span id="id2"></span><h3>Install NodeJS, JupyterLab, etc. in a conda environment<a class="headerlink" href="#install-nodejs-jupyterlab-etc-in-a-conda-environment" title="Link to this heading">#</a></h3>
<p>Next create a conda environment that includes:</p>
<ol class="arabic simple">
<li><p>The latest release of JupyterLab</p></li>
<li><p><a class="reference external" href="https://copier.readthedocs.io/">copier</a> and some dependencies, the tool
you’ll use to bootstrap your extension project structure (this is a Python tool
which we’ll install using conda below).</p></li>
<li><p><a class="reference external" href="https://nodejs.org/">NodeJS</a>, the JavaScript runtime you’ll use to
compile the web assets (e.g., TypeScript, CSS) for your extension</p></li>
<li><p><a class="reference external" href="https://git-scm.com/">git</a>, a version control system you’ll use to
take snapshots of your work as you progress through this tutorial</p></li>
</ol>
<p>It’s a best practice to leave the root conda environment (i.e., the environment created
by the miniconda installer) untouched and install your project-specific
dependencies in a named conda environment. Run this command to create a
new environment named <code class="docutils literal notranslate"><span class="pre">jupyterlab-ext</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>jupyterlab-ext<span class="w"> </span>--override-channels<span class="w"> </span>--strict-channel-priority<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>-c<span class="w"> </span>nodefaults<span class="w"> </span><span class="nv">jupyterlab</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="nv">nodejs</span><span class="o">=</span><span class="m">20</span><span class="w"> </span>git<span class="w"> </span><span class="nv">copier</span><span class="o">=</span><span class="m">9</span><span class="w"> </span>jinja2-time
</pre></div>
</div>
<p>Now activate the new environment so that all further commands you run
work out of that environment.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>activate<span class="w"> </span>jupyterlab-ext
</pre></div>
</div>
<p>Note: You’ll need to run the command above in each new terminal you open
before you can work with the tools you installed in the
<code class="docutils literal notranslate"><span class="pre">jupyterlab-ext</span></code> environment.</p>
</section>
</section>
<section id="create-a-repository">
<h2>Create a repository<a class="headerlink" href="#create-a-repository" title="Link to this heading">#</a></h2>
<p>Create a new repository for your extension (see, for example, the
<a class="reference external" href="https://docs.github.com/en/get-started/quickstart/create-a-repo">GitHub instructions</a>). This is an
optional step, but highly recommended if you want to share your
extension.</p>
</section>
<section id="create-an-extension-project">
<h2>Create an extension project<a class="headerlink" href="#create-an-extension-project" title="Link to this heading">#</a></h2>
<section id="initialize-the-project-from-the-template">
<h3>Initialize the project from the template<a class="headerlink" href="#initialize-the-project-from-the-template" title="Link to this heading">#</a></h3>
<p>Next use copier to create a new project for your extension.
This will create a new folder for your extension in your current directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>my_first_extension
<span class="nb">cd</span><span class="w"> </span>my_first_extension
copier<span class="w"> </span>copy<span class="w"> </span>--trust<span class="w"> </span>https://github.com/jupyterlab/extension-template<span class="w"> </span>.
</pre></div>
</div>
<p>When prompted, enter values like the following for all of the template
prompts (<code class="docutils literal notranslate"><span class="pre">apod</span></code> stands for Astronomy Picture of the Day, the NASA service we
are using to fetch pictures).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>What<span class="w"> </span>is<span class="w"> </span>your<span class="w"> </span>extension<span class="w"> </span>kind?
<span class="o">(</span>Use<span class="w"> </span>arrow<span class="w"> </span>keys<span class="o">)</span>
<span class="w"> </span>frontend
Extension<span class="w"> </span>author<span class="w"> </span>name
<span class="w"> </span>Your<span class="w"> </span>Name
Extension<span class="w"> </span>author<span class="w"> </span>email
<span class="w"> </span>your@name.org
JavaScript<span class="w"> </span>package<span class="w"> </span>name
<span class="w"> </span>jupyterlab_apod
Python<span class="w"> </span>package<span class="w"> </span>name
<span class="w"> </span>jupyterlab_apod
Extension<span class="w"> </span>short<span class="w"> </span>description
<span class="w"> </span>Show<span class="w"> </span>a<span class="w"> </span>random<span class="w"> </span>NASA<span class="w"> </span>Astronomy<span class="w"> </span>Picture<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Day<span class="w"> </span><span class="k">in</span><span class="w"> </span>a<span class="w"> </span>JupyterLab<span class="w"> </span>panel
Does<span class="w"> </span>the<span class="w"> </span>extension<span class="w"> </span>have<span class="w"> </span>user<span class="w"> </span>settings?
<span class="w"> </span>N
Do<span class="w"> </span>you<span class="w"> </span>want<span class="w"> </span>to<span class="w"> </span><span class="nb">set</span><span class="w"> </span>up<span class="w"> </span>Binder<span class="w"> </span>example?
<span class="w"> </span>Y
Do<span class="w"> </span>you<span class="w"> </span>want<span class="w"> </span>to<span class="w"> </span><span class="nb">set</span><span class="w"> </span>up<span class="w"> </span><span class="nb">test</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>extension?
<span class="w"> </span>Y
Git<span class="w"> </span>remote<span class="w"> </span>repository<span class="w"> </span>URL
<span class="w"> </span>https://github.com/github_username/jupyterlab_apod
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>If you are not using a repository, leave the repository field blank. You can come back and edit the repository field in the <code class="docutils literal notranslate"><span class="pre">package.json</span></code> file later.</p></li>
<li><p>If you are using the latest version of the template, you will notice that tests are included in the template. If you don’t want to include them just answer <code class="docutils literal notranslate"><span class="pre">n</span></code> to the test prompt.</p></li>
</ul>
</div>
<p>List the files.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ls<span class="w"> </span>-a
</pre></div>
</div>
<p>You should see a list like the following.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">copier</span><span class="o">-</span><span class="n">answers</span><span class="o">.</span><span class="n">yml</span>  <span class="o">.</span><span class="n">github</span>          <span class="o">.</span><span class="n">gitignore</span>      <span class="o">.</span><span class="n">prettierignore</span>     <span class="o">.</span><span class="n">yarnrc</span><span class="o">.</span><span class="n">yml</span>
<span class="n">babel</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">js</span>      <span class="n">jest</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">js</span>   <span class="n">pyproject</span><span class="o">.</span><span class="n">toml</span>  <span class="n">src</span>                 <span class="n">ui</span><span class="o">-</span><span class="n">tests</span>
<span class="n">binder</span>               <span class="n">jupyterlab_apod</span>  <span class="n">README</span><span class="o">.</span><span class="n">md</span>       <span class="n">style</span>               <span class="n">yarn</span><span class="o">.</span><span class="n">lock</span>
<span class="n">CHANGELOG</span><span class="o">.</span><span class="n">md</span>         <span class="n">LICENSE</span>          <span class="n">RELEASE</span><span class="o">.</span><span class="n">md</span>      <span class="n">tsconfig</span><span class="o">.</span><span class="n">json</span>
<span class="n">install</span><span class="o">.</span><span class="n">json</span>         <span class="n">package</span><span class="o">.</span><span class="n">json</span>     <span class="n">setup</span><span class="o">.</span><span class="n">py</span>        <span class="n">tsconfig</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
</section>
<section id="commit-what-you-have-to-git">
<h3>Commit what you have to git<a class="headerlink" href="#commit-what-you-have-to-git" title="Link to this heading">#</a></h3>
<p>Run the following commands in your <code class="docutils literal notranslate"><span class="pre">jupyterlab_apod</span></code> folder to
initialize it as a git repository and commit the current code.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>init
git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;Seed apod project from extension template&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This step is not technically necessary, but it is good practice to
track changes in version control system in case you need to rollback to
an earlier version or want to collaborate with others. You
can compare your work throughout this tutorial with the commits in a
reference version of <code class="docutils literal notranslate"><span class="pre">jupyterlab_apod</span></code> on GitHub at
<a class="github reference external" href="https://github.com/jupyterlab/jupyterlab_apod">jupyterlab/jupyterlab_apod</a>.</p>
</div>
</section>
<section id="build-and-install-the-extension-for-development">
<h3>Build and install the extension for development<a class="headerlink" href="#build-and-install-the-extension-for-development" title="Link to this heading">#</a></h3>
<p>Your new extension project has enough code in it to see it working in your
JupyterLab. Run the following commands to install the initial project
dependencies and install the extension into the JupyterLab environment.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>-ve<span class="w"> </span>.
</pre></div>
</div>
<p>The above command copies the frontend part of the extension into JupyterLab.
We can run this <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code> command again every time we make a change to
copy the change into JupyterLab. Even better, we can use
the <code class="docutils literal notranslate"><span class="pre">develop</span></code> command to create a symbolic link from JupyterLab to our
source directory. This means our changes are automatically available in
JupyterLab:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>jupyter<span class="w"> </span>labextension<span class="w"> </span>develop<span class="w"> </span>--overwrite<span class="w"> </span>.
</pre></div>
</div>
</section>
<section id="important-for-windows-users">
<span id="id3"></span><h3>Important for Windows users<a class="headerlink" href="#important-for-windows-users" title="Link to this heading">#</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>On Windows, symbolic links need to be activated on Windows 10 or above for Python version 3.8 or higher
by activating the ‘Developer Mode’. That may not be allowed by your administrators.
See <a class="reference external" href="https://docs.microsoft.com/en-us/windows/apps/get-started/enable-your-device-for-development">Activate Developer Mode on Windows</a>
for instructions.</p>
</div>
</section>
<section id="see-the-initial-extension-in-action">
<h3>See the initial extension in action<a class="headerlink" href="#see-the-initial-extension-in-action" title="Link to this heading">#</a></h3>
<p>After the install completes, open a second terminal. Run these commands to
activate the <code class="docutils literal notranslate"><span class="pre">jupyterlab-ext</span></code> environment and start JupyterLab in your
default web browser.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>activate<span class="w"> </span>jupyterlab-ext
jupyter<span class="w"> </span>lab
</pre></div>
</div>
<p>In that browser window, open the JavaScript console
by following the instructions for your browser:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://developer.chrome.com/devtools#access">Accessing the DevTools in Google
Chrome</a></p></li>
<li><p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Tools/Web_Console/Opening_the_Web_Console">Opening the Web Console in
Firefox</a></p></li>
</ul>
<p>After you reload the page with the console open, you should see a message that says
<code class="docutils literal notranslate"><span class="pre">JupyterLab</span> <span class="pre">extension</span> <span class="pre">jupyterlab_apod</span> <span class="pre">is</span> <span class="pre">activated!</span></code> in the console.
If you do, congratulations, you’re ready to start modifying the extension!
If not, go back make sure you didn’t miss a step, and <a class="reference external" href="https://github.com/jupyterlab/jupyterlab/blob/4.3.x/README.md#getting-help">reach
out</a> if you’re stuck.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Leave the terminal running the <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">lab</span></code> command open and running
JupyterLab to see the effects of changes below.</p>
</div>
</section>
</section>
<section id="add-an-astronomy-picture-of-the-day-widget">
<h2>Add an Astronomy Picture of the Day widget<a class="headerlink" href="#add-an-astronomy-picture-of-the-day-widget" title="Link to this heading">#</a></h2>
<section id="show-an-empty-panel">
<h3>Show an empty panel<a class="headerlink" href="#show-an-empty-panel" title="Link to this heading">#</a></h3>
<p>The <em>command palette</em> is the primary view of all commands available to
you in JupyterLab. For your first addition, you’re going to add a
<em>Random Astronomy Picture</em> command to the palette and get it to show an <em>Astronomy Picture</em>
tab panel when invoked.</p>
<p>Fire up your favorite text editor and open the <code class="docutils literal notranslate"><span class="pre">src/index.ts</span></code> file in your
extension project. Change the import at the top of the file to get a reference
to the command palette interface and the <code class="docutils literal notranslate"><span class="pre">JupyterFrontEnd</span></code> instance.</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">JupyterFrontEnd</span><span class="p">,</span>
<span class="w">  </span><span class="nx">JupyterFrontEndPlugin</span>
<span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@jupyterlab/application&#39;</span><span class="p">;</span>

<span class="hll"><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ICommandPalette</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@jupyterlab/apputils&#39;</span><span class="p">;</span>
</span></pre></div>
</div>
<p>Locate the <code class="docutils literal notranslate"><span class="pre">plugin</span></code> object of type <code class="docutils literal notranslate"><span class="pre">JupyterFrontEndPlugin</span></code>. Change the
definition so that it reads like so:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * Initialization data for the jupyterlab_apod extension.</span>
<span class="cm"> */</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">plugin</span><span class="o">:</span><span class="w"> </span><span class="kt">JupyterFrontEndPlugin</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;jupyterlab-apod&#39;</span><span class="p">,</span>
</span><span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Show a random NASA Astronomy Picture of the Day in a JupyterLab panel.&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">autoStart</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="hll"><span class="w">  </span><span class="nx">requires</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">ICommandPalette</span><span class="p">],</span>
</span><span class="hll"><span class="w">  </span><span class="nx">activate</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">app</span><span class="o">:</span><span class="w"> </span><span class="kt">JupyterFrontEnd</span><span class="p">,</span><span class="w"> </span><span class="nx">palette</span><span class="o">:</span><span class="w"> </span><span class="kt">ICommandPalette</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;JupyterLab extension jupyterlab_apod is activated!&#39;</span><span class="p">);</span>
<span class="hll"><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;ICommandPalette:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">palette</span><span class="p">);</span>
</span><span class="w">  </span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">requires</span></code> attribute states that your plugin needs an object that
implements the <code class="docutils literal notranslate"><span class="pre">ICommandPalette</span></code> interface when it starts. JupyterLab
will pass an instance of <code class="docutils literal notranslate"><span class="pre">ICommandPalette</span></code> as the second parameter of
<code class="docutils literal notranslate"><span class="pre">activate</span></code> in order to satisfy this requirement. Defining
<code class="docutils literal notranslate"><span class="pre">palette:</span> <span class="pre">ICommandPalette</span></code> makes this instance available to your code
in that function. The second <code class="docutils literal notranslate"><span class="pre">console.log</span></code> line exists only so that
you can immediately check that your changes work.</p>
<p>Now you will need to install these dependencies. Run the following commands in the
repository root folder to install the dependencies and save them to your
<cite>package.json</cite>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>jlpm<span class="w"> </span>add<span class="w"> </span>@jupyterlab/apputils<span class="w"> </span>@jupyterlab/application
</pre></div>
</div>
<p>Finally, run the following to rebuild your extension.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>jlpm<span class="w"> </span>run<span class="w"> </span>build
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial uses <code class="docutils literal notranslate"><span class="pre">jlpm</span></code> to install Javascript packages and
run build commands, which is JupyterLab’s bundled
version of <code class="docutils literal notranslate"><span class="pre">yarn</span></code>. If you prefer, you can use another Javascript
package manager like <code class="docutils literal notranslate"><span class="pre">npm</span></code> or <code class="docutils literal notranslate"><span class="pre">yarn</span></code> itself.</p>
</div>
<p>After the extension build finishes, return to the browser tab that opened when
you started JupyterLab. Refresh it and look in the console. You should see the
same activation message as before, plus the new message about the
ICommandPalette instance you just added. If you don’t, check the output of the
build command for errors and correct your code.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>JupyterLab extension jupyterlab_apod is activated!
ICommandPalette: Palette {_palette: CommandPalette}
</pre></div>
</div>
<p>Note that we had to run <code class="docutils literal notranslate"><span class="pre">jlpm</span> <span class="pre">run</span> <span class="pre">build</span></code> in order for the bundle to
update. This command does two things: compiles the TypeScript files in <code class="docutils literal notranslate"><span class="pre">src/`</span></code>
into JavaScript files in <code class="docutils literal notranslate"><span class="pre">lib/</span></code> (<code class="docutils literal notranslate"><span class="pre">jlpm</span> <span class="pre">run</span> <span class="pre">build</span></code>), then bundles the
JavaScript files in <code class="docutils literal notranslate"><span class="pre">lib/</span></code> into a JupyterLab extension in
<code class="docutils literal notranslate"><span class="pre">jupyterlab_apod/static</span></code> (<code class="docutils literal notranslate"><span class="pre">jlpm</span> <span class="pre">run</span> <span class="pre">build:extension</span></code>). If you wish to avoid
running <code class="docutils literal notranslate"><span class="pre">jlpm</span> <span class="pre">run</span> <span class="pre">build</span></code> after each change, you can open a third terminal,
activate the <code class="docutils literal notranslate"><span class="pre">jupyterlab-ext</span></code> environment, and run the <code class="docutils literal notranslate"><span class="pre">jlpm</span> <span class="pre">run</span> <span class="pre">watch</span></code>
command from your extension directory, which will automatically compile the
TypeScript files as they are changed and saved.</p>
<p>Now return to your editor. Modify the imports at the top of the file to add a
few more imports:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ICommandPalette</span><span class="p">,</span><span class="w"> </span><span class="nx">MainAreaWidget</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@jupyterlab/apputils&#39;</span><span class="p">;</span>
</span>
<span class="hll"><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Widget</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@lumino/widgets&#39;</span><span class="p">;</span>
</span></pre></div>
</div>
<p>Install this new dependency as well:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>jlpm<span class="w"> </span>add<span class="w"> </span>@lumino/widgets
</pre></div>
</div>
<p>Then modify the <code class="docutils literal notranslate"><span class="pre">activate</span></code> function inside the plugin object again so that
it has the following code <em>(the highlighted lines show the activate function, you’re
only modifying the contents of that function, so make sure your braces match,
and leave the</em> <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">default</span> <span class="pre">plugin</span></code> <em>part lower down intact)</em>:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">plugin</span><span class="o">:</span><span class="w"> </span><span class="kt">JupyterFrontEndPlugin</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;jupyterlab-apod&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Show a random NASA Astronomy Picture of the Day in a JupyterLab panel.&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">autoStart</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">  </span><span class="nx">requires</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">ICommandPalette</span><span class="p">],</span>
<span class="hll"><span class="w">  </span><span class="nx">activate</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">app</span><span class="o">:</span><span class="w"> </span><span class="kt">JupyterFrontEnd</span><span class="p">,</span><span class="w"> </span><span class="nx">palette</span><span class="o">:</span><span class="w"> </span><span class="kt">ICommandPalette</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;JupyterLab extension jupyterlab_apod is activated!&#39;</span><span class="p">);</span>
</span><span class="hll">
</span><span class="hll"><span class="w">    </span><span class="c1">// Define a widget creator function,</span>
</span><span class="hll"><span class="w">    </span><span class="c1">// then call it to make a new widget</span>
</span><span class="hll"><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">newWidget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">      </span><span class="c1">// Create a blank content widget inside of a MainAreaWidget</span>
</span><span class="hll"><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Widget</span><span class="p">();</span>
</span><span class="hll"><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">widget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MainAreaWidget</span><span class="p">({</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="p">});</span>
</span><span class="hll"><span class="w">      </span><span class="nx">widget</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;apod-jupyterlab&#39;</span><span class="p">;</span>
</span><span class="hll"><span class="w">      </span><span class="nx">widget</span><span class="p">.</span><span class="nx">title</span><span class="p">.</span><span class="nx">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Astronomy Picture&#39;</span><span class="p">;</span>
</span><span class="hll"><span class="w">      </span><span class="nx">widget</span><span class="p">.</span><span class="nx">title</span><span class="p">.</span><span class="nx">closable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span class="hll"><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">widget</span><span class="p">;</span>
</span><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><span class="hll"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">widget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">newWidget</span><span class="p">();</span>
</span><span class="hll">
</span><span class="hll"><span class="w">    </span><span class="c1">// Add an application command</span>
</span><span class="hll"><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">command</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;apod:open&#39;</span><span class="p">;</span>
</span><span class="hll"><span class="w">    </span><span class="nx">app</span><span class="p">.</span><span class="nx">commands</span><span class="p">.</span><span class="nx">addCommand</span><span class="p">(</span><span class="nx">command</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">      </span><span class="nx">label</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Random Astronomy Picture&#39;</span><span class="p">,</span>
</span><span class="hll"><span class="w">      </span><span class="nx">execute</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">        </span><span class="c1">// Regenerate the widget if disposed</span>
</span><span class="hll"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">widget</span><span class="p">.</span><span class="nx">isDisposed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">          </span><span class="nx">widget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">newWidget</span><span class="p">();</span>
</span><span class="hll"><span class="w">        </span><span class="p">}</span>
</span><span class="hll"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">widget</span><span class="p">.</span><span class="nx">isAttached</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">          </span><span class="c1">// Attach the widget to the main work area if it&#39;s not there</span>
</span><span class="hll"><span class="w">          </span><span class="nx">app</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">widget</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;main&#39;</span><span class="p">);</span>
</span><span class="hll"><span class="w">        </span><span class="p">}</span>
</span><span class="hll"><span class="w">        </span><span class="c1">// Activate the widget</span>
</span><span class="hll"><span class="w">        </span><span class="nx">app</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">activateById</span><span class="p">(</span><span class="nx">widget</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
</span><span class="hll"><span class="w">      </span><span class="p">}</span>
</span><span class="hll"><span class="w">    </span><span class="p">});</span>
</span><span class="hll">
</span><span class="hll"><span class="w">    </span><span class="c1">// Add the command to the palette.</span>
</span><span class="hll"><span class="w">    </span><span class="nx">palette</span><span class="p">.</span><span class="nx">addItem</span><span class="p">({</span><span class="w"> </span><span class="nx">command</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Tutorial&#39;</span><span class="w"> </span><span class="p">});</span>
</span><span class="hll"><span class="w">  </span><span class="p">}</span>
</span><span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="nx">plugin</span><span class="p">;</span>
</pre></div>
</div>
<p>The first new block of code defines (and calls) a reusable widget creator
function. That function returns a <code class="docutils literal notranslate"><span class="pre">MainAreaWidget</span></code> instance that has an
empty content <code class="docutils literal notranslate"><span class="pre">Widget</span></code> as its child. It also assigns the main area widget a
unique ID, gives it a label that will appear as its tab title, and makes the
tab closable by the user. The second block of code adds a new command with id
<code class="docutils literal notranslate"><span class="pre">apod:open</span></code> and label <em>Random Astronomy Picture</em> to JupyterLab. When the
command executes, it checks that the widget isn’t disposed, attaches the widget
to the main display area if it is not already present and then makes it the
active tab. The last new line of code uses the command id to add the command
to the command palette in a section called <em>Tutorial</em>.</p>
<p>Build your extension again using <code class="docutils literal notranslate"><span class="pre">jlpm</span> <span class="pre">run</span> <span class="pre">build</span></code> (unless you are using
<code class="docutils literal notranslate"><span class="pre">jlpm</span> <span class="pre">run</span> <span class="pre">watch</span></code> already) and refresh the browser tab. Open the command
palette by clicking on <em>Commands</em> from the View menu or using the keyboard
shortcut <code class="docutils literal notranslate"><span class="pre">Command/Ctrl</span> <span class="pre">Shift</span> <span class="pre">C</span></code> and type <em>Astronomy</em> in the search box. Your
<em>Random Astronomy Picture</em> command should appear. Click it or select it with
the keyboard and press <em>Enter</em>. You should see a new, blank panel appear with
the tab title <em>Astronomy Picture</em>. Click the <em>x</em> on the tab to close it and
activate the command again. The tab should reappear. Finally, click one of the
launcher tabs so that the <em>Astronomy Picture</em> panel is still open but no
longer active. Now run the <em>Random Astronomy Picture</em> command one more time.
The single <em>Astronomy Picture</em> tab should come to the foreground.</p>
<figure class="align-center" id="id6">
<img alt="The in-progress extension, showing a blank panel." class="jp-screenshot" src="../_images/extension_tutorial_empty.png" />
<figcaption>
<p><span class="caption-text">The in-progress extension, showing a blank panel.</span><a class="headerlink" href="#id6" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>If your widget is not behaving, compare your code with the reference
project state at the <a class="reference external" href="https://github.com/jupyterlab/jupyterlab_apod/tree/4.0-01-show-a-panel">01-show-a-panel
tag</a>.
Once you’ve got everything working properly, git commit your changes and
carry on.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>add<span class="w"> </span>package.json<span class="w"> </span>src/index.ts
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;Show Astronomy Picture command in palette&#39;</span>
</pre></div>
</div>
</section>
<section id="show-a-picture-in-the-panel">
<h3>Show a picture in the panel<a class="headerlink" href="#show-a-picture-in-the-panel" title="Link to this heading">#</a></h3>
<p>You now have an empty panel. It’s time to add a picture to it. Go back to
your code editor. Add the following code in the widget creator function below
the lines that create a <code class="docutils literal notranslate"><span class="pre">MainAreaWidget</span></code> instance and above the line that
returns the new widget.</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Add an image element to the content</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">img</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">);</span>
<span class="nx">content</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">img</span><span class="p">);</span>

<span class="c1">// Get a random date string in YYYY-MM-DD format</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">randomDate</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="mf">2010</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">();</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">randomDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nx">start</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="nx">end</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">start</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()));</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">randomDate</span><span class="p">.</span><span class="nx">toISOString</span><span class="p">().</span><span class="nx">slice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Fetch info about a random picture</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="sb">`https://api.nasa.gov/planetary/apod?api_key=DEMO_KEY&amp;date=</span><span class="si">${</span><span class="nx">randomDate</span><span class="p">()</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">()</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">APODResponse</span><span class="p">;</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">media_type</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;image&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Populate the image</span>
<span class="w">  </span><span class="nx">img</span><span class="p">.</span><span class="nx">src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">url</span><span class="p">;</span>
<span class="w">  </span><span class="nx">img</span><span class="p">.</span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Random APOD was not a picture.&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The first two lines create a new HTML <code class="docutils literal notranslate"><span class="pre">&lt;img&gt;</span></code> element and add it to
the widget DOM node. The next lines define a function get a random date in the form <code class="docutils literal notranslate"><span class="pre">YYYY-MM-DD</span></code> format, and then the function is used to make a request using the HTML
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch">fetch</a>
API that returns information about the Astronomy Picture of the Day for that date. Finally, we set the
image source and title attributes based on the response.</p>
<p>Now define the <code class="docutils literal notranslate"><span class="pre">APODResponse</span></code> type that was introduced in the code above. Put
this definition just under the imports at the top of the file.</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kd">interface</span><span class="w"> </span><span class="nx">APODResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">copyright</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">explanation</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">media_type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;video&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;image&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Then we need to add <code class="docutils literal notranslate"><span class="pre">async</span></code> and <code class="docutils literal notranslate"><span class="pre">await</span></code> to a few places in our code since
we’re using <code class="docutils literal notranslate"><span class="pre">await</span></code> in our widget creator function.</p>
<p>First, update the <code class="docutils literal notranslate"><span class="pre">activate</span></code> method to be <code class="docutils literal notranslate"><span class="pre">async</span></code>:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="nx">activate</span><span class="o">:</span><span class="w"> </span><span class="kt">async</span><span class="w"> </span><span class="p">(</span><span class="nx">app</span><span class="o">:</span><span class="w"> </span><span class="kt">JupyterFrontEnd</span><span class="p">,</span><span class="w"> </span><span class="nx">palette</span><span class="o">:</span><span class="w"> </span><span class="kt">ICommandPalette</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</pre></div>
</div>
<p>Next, update the <code class="docutils literal notranslate"><span class="pre">newWidget</span></code> function to be <code class="docutils literal notranslate"><span class="pre">async</span></code>:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">newWidget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</pre></div>
</div>
<p>Finally, add <code class="docutils literal notranslate"><span class="pre">await</span></code> to both of the <code class="docutils literal notranslate"><span class="pre">newWidget</span></code> function calls, and
<code class="docutils literal notranslate"><span class="pre">async</span></code> to the execute function:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">widget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">newWidget</span><span class="p">();</span>
</span>
<span class="w">  </span><span class="c1">// Add an application command</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">command</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;apod:open&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">app</span><span class="p">.</span><span class="nx">commands</span><span class="p">.</span><span class="nx">addCommand</span><span class="p">(</span><span class="nx">command</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">label</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Random Astronomy Picture&#39;</span><span class="p">,</span>
<span class="hll"><span class="w">    </span><span class="nx">execute</span><span class="o">:</span><span class="w"> </span><span class="kt">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span class="w">      </span><span class="c1">// Regenerate the widget if disposed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">widget</span><span class="p">.</span><span class="nx">isDisposed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="w">        </span><span class="nx">widget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">newWidget</span><span class="p">();</span>
</span><span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">widget</span><span class="p">.</span><span class="nx">isAttached</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Attach the widget to the main work area if it&#39;s not there</span>
<span class="w">        </span><span class="nx">app</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">widget</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;main&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="c1">// Activate the widget</span>
<span class="w">      </span><span class="nx">app</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">activateById</span><span class="p">(</span><span class="nx">widget</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">});</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are new to JavaScript / TypeScript and want to learn more about <code class="docutils literal notranslate"><span class="pre">async</span></code>, <code class="docutils literal notranslate"><span class="pre">await</span></code>,
and <code class="docutils literal notranslate"><span class="pre">Promises</span></code>, you can check out the following <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Asynchronous/Promises">tutorial on MDN</a></p>
<p>Be sure to also refer to the other resources in the
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Asynchronous/Promises#see_also">See Also</a>
section for more materials.</p>
</div>
<p>Rebuild your extension if necessary (<code class="docutils literal notranslate"><span class="pre">jlpm</span> <span class="pre">run</span> <span class="pre">build</span></code>), refresh your browser
tab, and run the <em>Random Astronomy Picture</em> command again. You should now see a
picture in the panel when it opens (if that random date had a picture and not a
video).</p>
<figure class="align-center" id="id7">
<img alt="../_images/extension_tutorial_single.png" class="jp-screenshot" src="../_images/extension_tutorial_single.png" />
<figcaption>
<p><span class="caption-text">The in-progress extension, showing the <a class="reference external" href="https://apod.nasa.gov/apod/ap140119.html">Astronomy Picture of the Day for 19 Jan 2014</a>.</span><a class="headerlink" href="#id7" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Note that the image is not centered in the panel nor does the panel
scroll if the image is larger than the panel area. You’ll address both
of these problems in the upcoming sections.</p>
<p>If you don’t see a image at all, compare your code with the
<a class="reference external" href="https://github.com/jupyterlab/jupyterlab_apod/tree/4.0-02-show-an-image">02-show-an-image
tag</a>
in the reference project. When it’s working, make another git commit.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>add<span class="w"> </span>src/index.ts
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;Show a picture in the panel&#39;</span>
</pre></div>
</div>
</section>
</section>
<section id="improve-the-widget-behavior">
<h2>Improve the widget behavior<a class="headerlink" href="#improve-the-widget-behavior" title="Link to this heading">#</a></h2>
<section id="center-the-image-add-attribution-and-error-messaging">
<h3>Center the image, add attribution, and error messaging<a class="headerlink" href="#center-the-image-add-attribution-and-error-messaging" title="Link to this heading">#</a></h3>
<p>Open <code class="docutils literal notranslate"><span class="pre">style/base.css</span></code> in our extension project directory for editing.
Add the following lines to it.</p>
<div class="highlight-css notranslate"><div class="highlight"><pre><span></span><span class="p">.</span><span class="nc">my-apodWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">  </span><span class="k">flex-direction</span><span class="p">:</span><span class="w"> </span><span class="kc">column</span><span class="p">;</span>
<span class="w">  </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">overflow</span><span class="p">:</span><span class="w"> </span><span class="kc">auto</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This CSS stacks content vertically within the widget panel and lets the panel
scroll when the content overflows. This CSS file is included on the page
automatically by JupyterLab because the <code class="docutils literal notranslate"><span class="pre">package.json</span></code> file has a <code class="docutils literal notranslate"><span class="pre">style</span></code>
field pointing to it. In general, you should import all of your styles into a
single CSS file, such as this <code class="docutils literal notranslate"><span class="pre">index.css</span></code> file, and put the path to that CSS
file in the <code class="docutils literal notranslate"><span class="pre">package.json</span></code> file <code class="docutils literal notranslate"><span class="pre">style</span></code> field.</p>
<p>Return to the <code class="docutils literal notranslate"><span class="pre">index.ts</span></code> file. Modify the <code class="docutils literal notranslate"><span class="pre">activate</span></code> function to apply the
CSS classes, the copyright information, and error handling for the API response.
You will be updating and replacing/removing some lines, so the beginning of the
function should read like the following:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="nx">activate</span><span class="o">:</span><span class="w"> </span><span class="kt">async</span><span class="w"> </span><span class="p">(</span><span class="nx">app</span><span class="o">:</span><span class="w"> </span><span class="kt">JupyterFrontEnd</span><span class="p">,</span><span class="w"> </span><span class="nx">palette</span><span class="o">:</span><span class="w"> </span><span class="kt">ICommandPalette</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;JupyterLab extension jupyterlab_apod is activated!&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Define a widget creator function,</span>
<span class="w">  </span><span class="c1">// then call it to make a new widget</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">newWidget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Create a blank content widget inside of a MainAreaWidget</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Widget</span><span class="p">();</span>
<span class="hll"><span class="w">    </span><span class="nx">content</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;my-apodWidget&#39;</span><span class="p">);</span>
</span><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">widget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MainAreaWidget</span><span class="p">({</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="nx">widget</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;apod-jupyterlab&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">widget</span><span class="p">.</span><span class="nx">title</span><span class="p">.</span><span class="nx">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Astronomy Picture&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">widget</span><span class="p">.</span><span class="nx">title</span><span class="p">.</span><span class="nx">closable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Add an image element to the content</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">img</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">content</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">img</span><span class="p">);</span>

<span class="hll"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">summary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">);</span>
</span><span class="hll"><span class="w">    </span><span class="nx">content</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">summary</span><span class="p">);</span>
</span>
<span class="w">    </span><span class="c1">// Get a random date string in YYYY-MM-DD format</span>
<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="nx">randomDate</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="mf">2010</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">();</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">randomDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nx">start</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="nx">end</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">start</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()));</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">randomDate</span><span class="p">.</span><span class="nx">toISOString</span><span class="p">().</span><span class="nx">slice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Fetch info about a random picture</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="sb">`https://api.nasa.gov/planetary/apod?api_key=DEMO_KEY&amp;date=</span><span class="si">${</span><span class="nx">randomDate</span><span class="p">()</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="hll"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
</span><span class="hll"><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">        </span><span class="nx">summary</span><span class="p">.</span><span class="nx">innerText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>
</span><span class="hll"><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">        </span><span class="nx">summary</span><span class="p">.</span><span class="nx">innerText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="p">;</span>
</span><span class="hll"><span class="w">      </span><span class="p">}</span>
</span><span class="hll"><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">()</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">APODResponse</span><span class="p">;</span>
</span><span class="hll">
</span><span class="hll"><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">media_type</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;image&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">        </span><span class="c1">// Populate the image</span>
</span><span class="hll"><span class="w">        </span><span class="nx">img</span><span class="p">.</span><span class="nx">src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">url</span><span class="p">;</span>
</span><span class="hll"><span class="w">        </span><span class="nx">img</span><span class="p">.</span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>
</span><span class="hll"><span class="w">        </span><span class="nx">summary</span><span class="p">.</span><span class="nx">innerText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>
</span><span class="hll"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">copyright</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">          </span><span class="nx">summary</span><span class="p">.</span><span class="nx">innerText</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="sb">` (Copyright </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">copyright</span><span class="si">}</span><span class="sb">)`</span><span class="p">;</span>
</span><span class="hll"><span class="w">        </span><span class="p">}</span>
</span><span class="hll"><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">        </span><span class="nx">summary</span><span class="p">.</span><span class="nx">innerText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Random APOD fetched was not an image.&#39;</span><span class="p">;</span>
</span><span class="hll"><span class="w">      </span><span class="p">}</span>
</span><span class="hll"><span class="w">    </span><span class="p">}</span>
</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">widget</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c1">// Keep all the remaining lines below the newWidget function</span>
<span class="w">  </span><span class="c1">// definition the same as before from here down ...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your image panel keeps showing an error message, you may need to update
your NASA API Key (too many image requests can max out your limit)</p>
</div>
<p>Build your extension if necessary (<code class="docutils literal notranslate"><span class="pre">jlpm</span> <span class="pre">run</span> <span class="pre">build</span></code>) and refresh your
JupyterLab browser tab. Invoke the <em>Random Astronomy Picture</em> command and
confirm the image is centered with the copyright information below it. Resize
the browser window or the panel so that the image is larger than the
available area. Make sure you can scroll the panel over the entire area
of the image.</p>
<p>If anything is not working correctly, compare your code with the reference project
<a class="reference external" href="https://github.com/jupyterlab/jupyterlab_apod/tree/4.0-03-style-and-attribute">03-style-and-attribute
tag</a>.
When everything is working as expected, make another commit.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>add<span class="w"> </span>style/base.css<span class="w"> </span>src/index.ts
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;Add styling, attribution, error handling&#39;</span>
</pre></div>
</div>
</section>
<section id="show-a-new-image-on-demand">
<h3>Show a new image on demand<a class="headerlink" href="#show-a-new-image-on-demand" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">activate</span></code> function has grown quite long, and there’s still more
functionality to add. Let’s refactor the code into two separate
parts:</p>
<ol class="arabic simple">
<li><p>An <code class="docutils literal notranslate"><span class="pre">APODWidget</span></code> that encapsulates the Astronomy Picture panel elements,
configuration, and soon-to-be-added update behavior</p></li>
<li><p>An <code class="docutils literal notranslate"><span class="pre">activate</span></code> function that adds the widget instance to the UI and
decide when the picture should refresh</p></li>
</ol>
<p>Start by refactoring the widget code into the new <code class="docutils literal notranslate"><span class="pre">APODWidget</span></code> class.</p>
<p>Add the class just below the definition of <code class="docutils literal notranslate"><span class="pre">APODResponse</span></code> in the <code class="docutils literal notranslate"><span class="pre">index.ts</span></code>
file.</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nx">APODWidget</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">Widget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="cm">/**</span>
<span class="cm">  * Construct a new APOD widget.</span>
<span class="cm">  */</span>
<span class="w">  </span><span class="kr">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">();</span>

<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;my-apodWidget&#39;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Add an image element to the panel</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">img</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">img</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Add a summary element to the panel</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">summary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">summary</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">  * The image element associated with the widget.</span>
<span class="cm">  */</span>
<span class="w">  </span><span class="k">readonly</span><span class="w"> </span><span class="nx">img</span><span class="o">:</span><span class="w"> </span><span class="kt">HTMLImageElement</span><span class="p">;</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">  * The summary text element associated with the widget.</span>
<span class="cm">  */</span>
<span class="w">  </span><span class="k">readonly</span><span class="w"> </span><span class="nx">summary</span><span class="o">:</span><span class="w"> </span><span class="kt">HTMLParagraphElement</span><span class="p">;</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">  * Handle update requests for the widget.</span>
<span class="cm">  */</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">updateAPODImage</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="sb">`https://api.nasa.gov/planetary/apod?api_key=DEMO_KEY&amp;date=</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">randomDate</span><span class="p">()</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">summary</span><span class="p">.</span><span class="nx">innerText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">summary</span><span class="p">.</span><span class="nx">innerText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">()</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">APODResponse</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">media_type</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;image&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Populate the image</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">img</span><span class="p">.</span><span class="nx">src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">url</span><span class="p">;</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">img</span><span class="p">.</span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">summary</span><span class="p">.</span><span class="nx">innerText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">copyright</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">summary</span><span class="p">.</span><span class="nx">innerText</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="sb">` (Copyright </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">copyright</span><span class="si">}</span><span class="sb">)`</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">summary</span><span class="p">.</span><span class="nx">innerText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Random APOD fetched was not an image.&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">  * Get a random date string in YYYY-MM-DD format.</span>
<span class="cm">  */</span>
<span class="w">  </span><span class="nx">randomDate</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="mf">2010</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">();</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">randomDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nx">start</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="nx">end</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">start</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()));</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">randomDate</span><span class="p">.</span><span class="nx">toISOString</span><span class="p">().</span><span class="nx">slice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You’ve written all of the code before. All you’ve done is restructure it
to use instance variables and move the image request to its own
function.</p>
<p>Next move the remaining logic in <code class="docutils literal notranslate"><span class="pre">activate</span></code> to a new, top-level
function just below the <code class="docutils literal notranslate"><span class="pre">APODWidget</span></code> class definition. Modify the code
to create a widget when one does not exist in the main JupyterLab area
or to refresh the image in the existing widget when the command runs again.
The code for the <code class="docutils literal notranslate"><span class="pre">activate</span></code> function should read as follows after
these changes:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* Activate the APOD widget extension.</span>
<span class="cm">*/</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">activate</span><span class="p">(</span><span class="nx">app</span><span class="o">:</span><span class="w"> </span><span class="kt">JupyterFrontEnd</span><span class="p">,</span><span class="w"> </span><span class="nx">palette</span><span class="o">:</span><span class="w"> </span><span class="kt">ICommandPalette</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;JupyterLab extension jupyterlab_apod is activated!&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Define a widget creator function</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">newWidget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">APODWidget</span><span class="p">();</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">widget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MainAreaWidget</span><span class="p">({</span><span class="nx">content</span><span class="p">});</span>
<span class="w">    </span><span class="nx">widget</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;apod-jupyterlab&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">widget</span><span class="p">.</span><span class="nx">title</span><span class="p">.</span><span class="nx">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Astronomy Picture&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">widget</span><span class="p">.</span><span class="nx">title</span><span class="p">.</span><span class="nx">closable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">widget</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Create a single widget</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">widget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">newWidget</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Add an application command</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">command</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;apod:open&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">app</span><span class="p">.</span><span class="nx">commands</span><span class="p">.</span><span class="nx">addCommand</span><span class="p">(</span><span class="nx">command</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">label</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Random Astronomy Picture&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">execute</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Regenerate the widget if disposed</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">widget</span><span class="p">.</span><span class="nx">isDisposed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">widget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">newWidget</span><span class="p">();</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">widget</span><span class="p">.</span><span class="nx">isAttached</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Attach the widget to the main work area if it&#39;s not there</span>
<span class="w">        </span><span class="nx">app</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">widget</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;main&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="c1">// Refresh the picture in the widget</span>
<span class="w">      </span><span class="nx">widget</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">updateAPODImage</span><span class="p">();</span>
<span class="w">      </span><span class="c1">// Activate the widget</span>
<span class="w">      </span><span class="nx">app</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">activateById</span><span class="p">(</span><span class="nx">widget</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="c1">// Add the command to the palette.</span>
<span class="w">  </span><span class="nx">palette</span><span class="p">.</span><span class="nx">addItem</span><span class="p">({</span><span class="w"> </span><span class="nx">command</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Tutorial&#39;</span><span class="w"> </span><span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Remove the <code class="docutils literal notranslate"><span class="pre">activate</span></code> function definition from the
<code class="docutils literal notranslate"><span class="pre">JupyterFrontEndPlugin</span></code> object and refer instead to the top-level function
like this:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">plugin</span><span class="o">:</span><span class="w"> </span><span class="kt">JupyterFrontEndPlugin</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;jupyterlab_apod&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">autoStart</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">  </span><span class="nx">requires</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">ICommandPalette</span><span class="p">],</span>
<span class="w">  </span><span class="nx">activate</span><span class="o">:</span><span class="w"> </span><span class="kt">activate</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Make sure you retain the <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">default</span> <span class="pre">plugin;</span></code> line in the file.
Now build the extension again and refresh the JupyterLab browser tab.
Run the <em>Random Astronomy Picture</em> command more than once without closing the
panel. The picture should update each time you execute the command. Close
the panel, run the command, and it should both reappear and show a new
image.</p>
<p>If anything is not working correctly, compare your code with the
<a class="reference external" href="https://github.com/jupyterlab/jupyterlab_apod/tree/4.0-04-refactor-and-refresh">04-refactor-and-refresh
tag</a>
to debug. Once it is working properly, commit it.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>add<span class="w"> </span>src/index.ts
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;Refactor, refresh image&#39;</span>
</pre></div>
</div>
</section>
<section id="restore-panel-state-when-the-browser-refreshes">
<h3>Restore panel state when the browser refreshes<a class="headerlink" href="#restore-panel-state-when-the-browser-refreshes" title="Link to this heading">#</a></h3>
<p>You may notice that every time you refresh your browser tab, the Astronomy Picture
panel disappears, even if it was open before you refreshed. Other open
panels, like notebooks, terminals, and text editors, all reappear and
return to where you left them in the panel layout. You can make your
extension behave this way too.</p>
<p>Update the imports at the top of your <code class="docutils literal notranslate"><span class="pre">index.ts</span></code> file so that the
entire list of import statements looks like the following (Adding
<code class="docutils literal notranslate"><span class="pre">ILayoutRestorer</span></code> and <code class="docutils literal notranslate"><span class="pre">WidgetTracker</span></code>):</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="w">  </span><span class="nx">ILayoutRestorer</span><span class="p">,</span>
</span><span class="w">  </span><span class="nx">JupyterFrontEnd</span><span class="p">,</span>
<span class="w">  </span><span class="nx">JupyterFrontEndPlugin</span>
<span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@jupyterlab/application&#39;</span><span class="p">;</span>

<span class="hll"><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">  </span><span class="nx">ICommandPalette</span><span class="p">,</span>
</span><span class="hll"><span class="w">  </span><span class="nx">MainAreaWidget</span><span class="p">,</span>
</span><span class="hll"><span class="w">  </span><span class="nx">WidgetTracker</span>
</span><span class="hll"><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@jupyterlab/apputils&#39;</span><span class="p">;</span>
</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Widget</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@lumino/widgets&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>Then add the <code class="docutils literal notranslate"><span class="pre">ILayoutRestorer</span></code> interface to the <code class="docutils literal notranslate"><span class="pre">JupyterFrontEndPlugin</span></code>
definition as <code class="docutils literal notranslate"><span class="pre">optional</span></code>. This addition passes the global <code class="docutils literal notranslate"><span class="pre">LayoutRestorer</span></code> as the
third parameter of the <code class="docutils literal notranslate"><span class="pre">activate</span></code> function.</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">plugin</span><span class="o">:</span><span class="w"> </span><span class="kt">JupyterFrontEndPlugin</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;jupyterlab-apod&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Show a random NASA Astronomy Picture of the Day in a JupyterLab panel.&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">autoStart</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">  </span><span class="nx">requires</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">ICommandPalette</span><span class="p">],</span>
<span class="hll"><span class="w">  </span><span class="nx">optional</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="nx">ILayoutRestorer</span><span class="p">],</span>
</span><span class="w">  </span><span class="nx">activate</span><span class="o">:</span><span class="w"> </span><span class="kt">activate</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">ILayoutRestorer</span></code> is specified as an <code class="docutils literal notranslate"><span class="pre">optional</span></code> token, as the corresponding service might
not be available in a customized JupyterLab distribution that does not provide layout restoration
functionalities. Having it <code class="docutils literal notranslate"><span class="pre">optional</span></code> make it a nice to have, and enable your extension to be loaded
in more JupyterLab based applications.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can learn more about <code class="docutils literal notranslate"><span class="pre">requires</span></code> and <code class="docutils literal notranslate"><span class="pre">optional</span></code> in the <a class="reference internal" href="extension_dev.html#tokens"><span class="std std-ref">Tokens</span></a> section
of the Extension Developer Guide.</p>
</div>
<p>Finally, rewrite the <code class="docutils literal notranslate"><span class="pre">activate</span></code> function so that it:</p>
<ol class="arabic simple">
<li><p>Declares a widget variable, but does not create an instance
immediately.</p></li>
<li><p>Adds the global <code class="docutils literal notranslate"><span class="pre">LayoutRestorer</span></code> as the third parameter of the <code class="docutils literal notranslate"><span class="pre">activate</span></code> function.
This parameter is declared as <code class="docutils literal notranslate"><span class="pre">ILayoutRestorer</span> <span class="pre">|</span> <span class="pre">null</span></code> since the token is specified as <code class="docutils literal notranslate"><span class="pre">optional</span></code>.</p></li>
<li><p>Constructs a <code class="docutils literal notranslate"><span class="pre">WidgetTracker</span></code> and tells the <code class="docutils literal notranslate"><span class="pre">ILayoutRestorer</span></code>
to use it to save/restore panel state.</p></li>
<li><p>Creates, tracks, shows, and refreshes the widget panel appropriately.</p></li>
</ol>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">activate</span><span class="p">(</span><span class="nx">app</span><span class="o">:</span><span class="w"> </span><span class="kt">JupyterFrontEnd</span><span class="p">,</span><span class="w"> </span><span class="nx">palette</span><span class="o">:</span><span class="w"> </span><span class="kt">ICommandPalette</span><span class="p">,</span><span class="w"> </span><span class="nx">restorer</span><span class="o">:</span><span class="w"> </span><span class="kt">ILayoutRestorer</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;JupyterLab extension jupyterlab_apod is activated!&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Declare a widget variable</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">widget</span><span class="o">:</span><span class="w"> </span><span class="kt">MainAreaWidget</span><span class="o">&lt;</span><span class="nx">APODWidget</span><span class="o">&gt;</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Add an application command</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">command</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;apod:open&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">app</span><span class="p">.</span><span class="nx">commands</span><span class="p">.</span><span class="nx">addCommand</span><span class="p">(</span><span class="nx">command</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">label</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Random Astronomy Picture&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">execute</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">widget</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">widget</span><span class="p">.</span><span class="nx">isDisposed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">APODWidget</span><span class="p">();</span>
<span class="w">        </span><span class="nx">widget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MainAreaWidget</span><span class="p">({</span><span class="nx">content</span><span class="p">});</span>
<span class="w">        </span><span class="nx">widget</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;apod-jupyterlab&#39;</span><span class="p">;</span>
<span class="w">        </span><span class="nx">widget</span><span class="p">.</span><span class="nx">title</span><span class="p">.</span><span class="nx">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Astronomy Picture&#39;</span><span class="p">;</span>
<span class="w">        </span><span class="nx">widget</span><span class="p">.</span><span class="nx">title</span><span class="p">.</span><span class="nx">closable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">tracker</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">widget</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Track the state of the widget for later restoration</span>
<span class="w">        </span><span class="nx">tracker</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">widget</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">widget</span><span class="p">.</span><span class="nx">isAttached</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Attach the widget to the main work area if it&#39;s not there</span>
<span class="w">        </span><span class="nx">app</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">widget</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;main&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="nx">widget</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">updateAPODImage</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// Activate the widget</span>
<span class="w">      </span><span class="nx">app</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">activateById</span><span class="p">(</span><span class="nx">widget</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="c1">// Add the command to the palette.</span>
<span class="w">  </span><span class="nx">palette</span><span class="p">.</span><span class="nx">addItem</span><span class="p">({</span><span class="w"> </span><span class="nx">command</span><span class="p">,</span><span class="w"> </span><span class="nx">category</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Tutorial&#39;</span><span class="w"> </span><span class="p">});</span>

<span class="w">  </span><span class="c1">// Track and restore the widget state</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">tracker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">WidgetTracker</span><span class="o">&lt;</span><span class="nx">MainAreaWidget</span><span class="o">&lt;</span><span class="nx">APODWidget</span><span class="o">&gt;&gt;</span><span class="p">({</span>
<span class="w">    </span><span class="nx">namespace</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;apod&#39;</span>
<span class="w">  </span><span class="p">});</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">restorer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">restorer</span><span class="p">.</span><span class="nx">restore</span><span class="p">(</span><span class="nx">tracker</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">command</span><span class="p">,</span>
<span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s1">&#39;apod&#39;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Rebuild your extension one last time and refresh your browser tab.
Execute the <em>Random Astronomy Picture</em> command and validate that the panel
appears with an image in it. Refresh the browser tab again. You should
see an Astronomy Picture panel reappear immediately without running the command. Close
the panel and refresh the browser tab. You should then not see an Astronomy Picture tab
after the refresh.</p>
<figure class="align-center" id="id8">
<img alt="The completed extension, showing the Astronomy Picture of the Day for 24 Jul 2015." class="jp-screenshot" src="../_images/extension_tutorial_complete.png" />
<figcaption>
<p><span class="caption-text">The completed extension, showing the <a class="reference external" href="https://apod.nasa.gov/apod/ap150724.html">Astronomy Picture of the Day for 24 Jul 2015</a>.</span><a class="headerlink" href="#id8" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Refer to the <a class="reference external" href="https://github.com/jupyterlab/jupyterlab_apod/tree/4.0-05-restore-panel-state">05-restore-panel-state
tag</a>
if your extension is not working correctly. Make a commit when the state of your
extension persists properly.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>add<span class="w"> </span>src/index.ts
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;Restore panel state&#39;</span>
</pre></div>
</div>
<p>Congratulations! You’ve implemented all of the behaviors laid out at the start
of this tutorial.</p>
</section>
</section>
<section id="packaging-your-extension">
<span id="id4"></span><h2>Packaging your extension<a class="headerlink" href="#packaging-your-extension" title="Link to this heading">#</a></h2>
<p>JupyterLab extensions for JupyterLab 3.0 and above can be distributed as Python
packages. The extension template we used contains all of the Python
packaging instructions in the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file to wrap your extension in a
Python package. Before generating a package, we first need to install <code class="docutils literal notranslate"><span class="pre">build</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>build
</pre></div>
</div>
<p>To create a Python source package (<code class="docutils literal notranslate"><span class="pre">.tar.gz</span></code>) in the <code class="docutils literal notranslate"><span class="pre">dist/</span></code> directory, do:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>build<span class="w"> </span>-s
</pre></div>
</div>
<p>To create a Python wheel package (<code class="docutils literal notranslate"><span class="pre">.whl</span></code>) in the <code class="docutils literal notranslate"><span class="pre">dist/</span></code> directory, do:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>build
</pre></div>
</div>
<p>Both of these commands will build the JavaScript into a bundle in the
<code class="docutils literal notranslate"><span class="pre">jupyterlab_apod/labextension/static</span></code> directory, which is then distributed with the
Python package. This bundle will include any necessary JavaScript dependencies
as well. You may want to check in the <code class="docutils literal notranslate"><span class="pre">jupyterlab_apod/labextension/static</span></code> directory to
retain a record of what JavaScript is distributed in your package, or you may
want to keep this “build artifact” out of your source repository history.</p>
<p>You can now try installing your extension as a user would. Open a new terminal
and run the following commands to create a new environment and install your
extension.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>jupyterlab-apod<span class="w"> </span>jupyterlab
conda<span class="w"> </span>activate<span class="w"> </span>jupyterlab-apod
pip<span class="w"> </span>install<span class="w"> </span>jupyterlab_apod/dist/jupyterlab_apod-0.1.0-py3-none-any.whl
jupyter<span class="w"> </span>lab
</pre></div>
</div>
<p>You should see a fresh JupyterLab browser tab appear. When it does,
execute the <em>Random Astronomy Picture</em> command to check that your extension
works.</p>
</section>
<section id="publishing-your-extension">
<span id="extension-tutorial-publish"></span><h2>Publishing your extension<a class="headerlink" href="#publishing-your-extension" title="Link to this heading">#</a></h2>
<p>You can publish your Python package to the <a class="reference external" href="https://pypi.org/">PyPI</a> or
<a class="reference external" href="https://conda-forge.org/">conda-forge</a> repositories so users can easily
install the extension using <code class="docutils literal notranslate"><span class="pre">pip</span></code> or <code class="docutils literal notranslate"><span class="pre">conda</span></code>.</p>
<p>You may want to also publish your extension as a JavaScript package to the
<a class="reference external" href="https://www.npmjs.com/">npm</a> package repository for several reasons:</p>
<ol class="arabic simple">
<li><p>Distributing an extension as an npm package allows users to compile the
extension into JupyterLab explicitly (similar to how was done in JupyterLab
versions 1 and 2), which leads to a more optimal JupyterLab package.</p></li>
<li><p>As we saw above, JupyterLab enables extensions to use services provided by
other extensions. For example, our extension above uses the <code class="docutils literal notranslate"><span class="pre">ICommandPalette</span></code>
and <code class="docutils literal notranslate"><span class="pre">ILayoutRestorer</span></code> services provided by core extensions in
JupyterLab. We were able to tell JupyterLab we required these services by
importing their tokens from the <code class="docutils literal notranslate"><span class="pre">&#64;jupyterlab/apputils</span></code> and
<code class="docutils literal notranslate"><span class="pre">&#64;jupyterlab/application</span></code> npm packages and listing them in our plugin
definition. If you want to provide a service to the JupyterLab system
for other extensions to use, you will need to publish your JavaScript
package to npm so other extensions can depend on it and import and require
your token.</p></li>
</ol>
<section id="automated-releases">
<h3>Automated Releases<a class="headerlink" href="#automated-releases" title="Link to this heading">#</a></h3>
<p>If you used the template to bootstrap your extension, the repository should already
be compatible with the <a class="reference external" href="https://github.com/jupyter-server/jupyter_releaser">Jupyter Releaser</a>.</p>
<p>The Jupyter Releaser provides a set of GitHub Actions Workflows to:</p>
<ul class="simple">
<li><p>Generate a new entry in the Changelog</p></li>
<li><p>Draft a new release</p></li>
<li><p>Publish the release to <code class="docutils literal notranslate"><span class="pre">PyPI</span></code> and <code class="docutils literal notranslate"><span class="pre">npm</span></code></p></li>
</ul>
<p>For more information on how to run the release workflows,
check out the documentation: <a class="github reference external" href="https://github.com/jupyter-server/jupyter_releaser">jupyter-server/jupyter_releaser</a></p>
</section>
</section>
<section id="learn-more">
<h2>Learn more<a class="headerlink" href="#learn-more" title="Link to this heading">#</a></h2>
<p>You’ve completed the tutorial. Nicely done! If you want to keep
learning, here are some suggestions about what to try next:</p>
<ul class="simple">
<li><p>Add the image description that comes in the API response to the panel.</p></li>
<li><p>Assign a default hotkey to the <em>Random Astronomy Picture</em> command.</p></li>
<li><p>Make the image a link to the picture on the NASA website (URLs are of the form <code class="docutils literal notranslate"><span class="pre">https://apod.nasa.gov/apod/apYYMMDD.html</span></code>).</p></li>
<li><p>Make the image title and description update after the image loads so that the picture and description are always synced.</p></li>
<li><p>Give users the ability to pin pictures in separate, permanent panels.</p></li>
<li><p>Add a setting for the user to put in their <a class="reference external" href="https://api.nasa.gov/#authentication">API key</a> so they can make many more requests per hour than the demo key allows.</p></li>
<li><p>Push your extension git repository to GitHub.</p></li>
<li><p>Learn how to write <a class="reference internal" href="extension_dev.html#developer-extensions"><span class="std std-ref">other kinds of extensions</span></a>.</p></li>
</ul>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="identity.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Identity</p>
      </div>
    </a>
    <a class="right-next"
       href="extension_multiple_ui.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Targeting Multiple Applications</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-a-development-environment">Set up a development environment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-conda-using-miniconda">Install conda using miniconda</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-nodejs-jupyterlab-etc-in-a-conda-environment">Install NodeJS, JupyterLab, etc. in a conda environment</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-repository">Create a repository</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-an-extension-project">Create an extension project</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-the-project-from-the-template">Initialize the project from the template</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#commit-what-you-have-to-git">Commit what you have to git</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-and-install-the-extension-for-development">Build and install the extension for development</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#important-for-windows-users">Important for Windows users</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#see-the-initial-extension-in-action">See the initial extension in action</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-an-astronomy-picture-of-the-day-widget">Add an Astronomy Picture of the Day widget</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#show-an-empty-panel">Show an empty panel</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#show-a-picture-in-the-panel">Show a picture in the panel</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#improve-the-widget-behavior">Improve the widget behavior</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#center-the-image-add-attribution-and-error-messaging">Center the image, add attribution, and error messaging</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#show-a-new-image-on-demand">Show a new image on demand</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#restore-panel-state-when-the-browser-refreshes">Restore panel state when the browser refreshes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#packaging-your-extension">Packaging your extension</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#publishing-your-extension">Publishing your extension</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#automated-releases">Automated Releases</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learn-more">Learn more</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/jupyterlab/jupyterlab/edit/4.3.x/docs/source/extension/extension_tutorial.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/extension/extension_tutorial.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrapb6e5.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-themeb6e5.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item"><!--
  ~ Copyright (c) Jupyter Development Team.
  ~ Distributed under the terms of the Modified BSD License.
-->

<div role="contentinfo">
  <p>
      &copy; Copyright 2018-2025, Project Jupyter.<br/>
      The Jupyter Trademark is registered with the U.S. Patent &amp Trademark Office.
      

  </p>
</div></div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>

<!-- Mirrored from jupyterlab.readthedocs.io/en/stable/extension/extension_tutorial.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Feb 2025 04:17:27 GMT -->
</html>